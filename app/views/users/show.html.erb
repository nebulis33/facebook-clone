<header><%= render 'shared/navbar' %></header>

<h1><%= @user.name %></h1>

<p>
    <% if current_user.pending_sent_requests.include?(@user) %>
        <%= "Friend request pending." %>
    <% elsif current_user.pending_received_requests.include?(@user) %>
        <%= "#{@user.name} sent you a request!"  %>
        <%= link_to "Accept", user_friendship_path(@user), method: 'patch' %>
        <%= link_to "Deny", user_friendship_path(@user), method: 'delete' %>
    <% elsif current_user.friends.include?(@user) %>
        <%= "Friends" %>
    <% else %>
        <%= link_to "Send friend request", user_friendship_path(@user), method: 'post' unless @user == current_user %>
    <% end %>
</p>
<%= render 'posts/form' %>
<section class="post">
    <% @user.posts.each do |post| %>
        <p><%= render partial: 'shared/post', locals: {user: @user, post: post} %></p>
        <p><%= render partial: 'comments/form', locals: {post: post} %></p>
        <p><%= render partial: 'shared/comments', locals: {user: @user, post: post} %></p>
    <% end %>
</section>